---
name: uitest
on:
  schedule:
    - cron: '40 5 * * 1-5'
  workflow_dispatch:

jobs:
  mrtest:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        browser: [chrome]
    container: cypress/browsers:node16.16.0-chrome107-ff107-edge
    steps:
      - uses: actions/checkout@v3
      - uses: cypress-io/github-action@v5
        with:
          runTests: false
      - name: "Get current date"
        run:  |
          echo "builddate=$(date +'%Y-%m-%d')" >> $GITHUB_OUTPUT
        id: version  # this is used on variable path

      - uses: cypress-io/github-action@v5
        with:
          install: false
          wait-on: "https://uitest.test.medirecords.com/"
          browser: ${{ matrix.browser }}
          record: false
          parallel: false
          config: "baseUrl=https://uitest.test.medirecords.com/"
          env: ${{steps.version.outputs.buildate}}

      - uses: actions/upload-artifact@v2
        if: ${{ always() }}
        with:
          name: ${{steps.version.outputs.buildate}}
          path: test-reports

      # - uses: actions/upload-artifact@v2
      #   with:
      #     name: cypress-videos
      #     path: cypress/vidoes
      # - uses: actions/upload-artifact@v2
      #   with:
      #     name: cypress-screenshots
      #     path: cypress/screenshots
